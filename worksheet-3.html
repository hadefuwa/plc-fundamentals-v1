<!DOCTYPE html>
<html lang="en">
<head>
  <meta charset="UTF-8">
  <meta name="viewport" content="width=device-width, initial-scale=1.0">
  <title>Matrix TSL - Status LED System Maintenance</title>
  <link rel="stylesheet" href="main.css">
  <link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/6.5.1/css/all.min.css">
  <link rel="icon" type="image/x-icon" href="assets/icons/matrix-icon.ico">    <script src="worksheet-core.js"></script>
<script src="worksheet-tracking.js"></script>

</head>
<body>
  <!-- Navigation -->
  <nav class="main-navigation">
    <div class="nav-container">
      <div class="nav-logo">
        <img src="assets/matrix-logo.png" alt="Matrix Logo">
      </div>
      <ul class="nav-menu" id="nav-menu">
        <li class="nav-item">
          <a href="#" onclick="window.location='index.html'" class="nav-link">
            <i class="fas fa-home"></i> HOME
          </a>
        </li>
        <li class="nav-item">
          <a href="#" onclick="window.location='CP2388-worksheets.html'" class="nav-link active">
            <i class="fas fa-cogs"></i> CP2388
          </a>
        </li>
        <li class="nav-item">
          
        </li>
        
        <li class="nav-item">
          <a href="#" onclick="window.location='tracking-dashboard.html'" class="nav-link">
            <i class="fas fa-chart-line"></i> PROGRESS
          </a>
        </li>
        <li class="nav-item">
          <a href="#" onclick="window.location='about.html'" class="nav-link">
            <i class="fas fa-info-circle"></i> ABOUT
          </a>
        </li>
      </ul>
    </div>
  </nav>

  <!-- Main Content -->
  <div class="worksheet-box">
    <!-- Integrated Worksheet Header -->
    <div class="worksheet-header">
      <div class="worksheet-header-content">
        <div class="worksheet-header-left">
          <button class="worksheet-nav-btn worksheet-back-btn" onclick="window.location.href='worksheet-2.html'">
            <i class="fas fa-arrow-left"></i>
            <span>Previous Worksheet</span>
          </button>
        </div>
        <div class="worksheet-header-center">
          <h1 class="worksheet-title">Worksheet 3 - Status LED System Maintenance</h1>
        </div>
        <div class="worksheet-header-right">
          <button class="worksheet-nav-btn worksheet-next-btn" onclick="window.location.href='worksheet-4.html'">
            <span>Next Worksheet</span>
            <i class="fas fa-chevron-right"></i>
          </button>
        </div>
      </div>
    </div>
    <!-- Introduction Section -->
    <div class="worksheet-section introduction-section">
      <h2 class="section-header"><i class="fas fa-info-circle"></i> 1. Introduction</h2>
      <div class="worksheet-content">
        <div class="introduction-content-wrapper">
          <div class="introduction-text">
            <p>Status LEDs provide instant visual feedback about system conditions and are essential for quick diagnosis. These simple but critical indicators help operators understand system status at a glance.</p>
          </div>
          <div class="introduction-image">
            <div class="system-diagram">
              <img src="assets/maintenance/status-led.png" alt="Status LED System">
            </div>
          </div>
        </div>
      </div>
    </div>

    <!-- Over To You Section -->
    <div class="worksheet-section over-to-you-section">
      <h2 class="section-header"><i class="fas fa-hands-helping"></i> 2. Over To You</h2>
      <div class="worksheet-content">
        <p><strong>Follow these steps to understand how the Status LED works as a diagnostic tool:</strong></p>
        
        <div class="steps-container">
          <div class="step-card" data-step="1">
            <div class="step-number">1</div>
            <div class="step-content">
              <div class="step-header">
                <h4>Normal Operation</h4>
                <label class="step-checkbox">
                  <input type="checkbox" class="step-complete-checkbox">
                  <span class="checkmark"></span>
                </label>
              </div>
              <p>Run the system as you have done previously. Locate the Status LED on your training system and observe the LED colour during normal operation.</p>
            </div>
          </div>
          
          <div class="step-card" data-step="2">
            <div class="step-number">2</div>
            <div class="step-content">
              <div class="step-header">
                <h4>Trigger a System Fault</h4>
                <label class="step-checkbox">
                  <input type="checkbox" class="step-complete-checkbox">
                  <span class="checkmark"></span>
                </label>
              </div>
              <p>Fully close the hand valve and watch as the system errors out. Observe how the LED changes colour to indicate a fault. Then restore normal operation by reopening the valve and resetting the system.</p>
            </div>
          </div>
          
          <div class="step-card" data-step="3">
            <div class="step-number">3</div>
            <div class="step-content">
              <div class="step-header">
                <h4>Trigger a Safety Fault</h4>
                <label class="step-checkbox">
                  <input type="checkbox" class="step-complete-checkbox">
                  <span class="checkmark"></span>
                </label>
              </div>
              <p>Press the Emergency Stop and observe how the system goes into a safety error mode. Note the colour of the LED and then reset the E-Stop by twisting it anti-clockwise and pressing the blue reset button.</p>
            </div>
          </div>
        </div>
      </div>
    </div>

    <!-- So What Section -->
    <div class="worksheet-section so-what-section">
      <h2 class="section-header"><i class="fas fa-lightbulb"></i> 3. So What?</h2>
      <div class="so-what-content">
        <p>The Status LED has three colour states that provide instant visual feedback about system conditions:</p>
        
        <div class="key-point">
          <i class="fas fa-circle" style="color: #4CAF50;"></i>
          <div>
            <strong>Green - Normal Operation</strong>
            <p>System is operating normally and all parameters are within acceptable ranges.</p>
          </div>
        </div>
        
        <div class="key-point">
          <i class="fas fa-circle" style="color: #FF9800;"></i>
          <div>
            <strong>Orange - Fault Detected</strong>
            <p>A fault has been detected, but the system may still function. Investigate the issue to prevent escalation.</p>
          </div>
        </div>
        
        <div class="key-point">
          <i class="fas fa-circle" style="color: #F44336;"></i>
          <div>
            <strong>Red - Safety Fault</strong>
            <p>A safety fault has occurred. The system requires immediate attention before it can restart.</p>
          </div>
        </div>
        
        <div class="key-point">
          <i class="fas fa-lightbulb"></i>
          <div>
            <strong>Preventive Maintenance</strong>
            <p>Using the Status LED as a diagnostic tool helps with preventive maintenance and troubleshooting. Regular monitoring helps prevent downtime and ensures faults are addressed before escalating.</p>
          </div>
        </div>
      </div>
    </div>

    <!-- Questions Section -->
    <div class="worksheet-section questions-section">
      <h2 class="section-header"><i class="fas fa-question-circle"></i> Questions & Answers</h2>
      <div class="questions-content">
        <div class="question-item" data-question="1">
          <h4>Question 1: What is the purpose of the Status LED in the system?</h4>
          <div class="multiple-choice-options">
            <label class="option-label">
              <input type="radio" name="question-1" value="A" class="option-radio">
              <span class="option-text">A) To indicate the system's condition and help quickly identify faults and safety issues for efficient maintenance</span>
            </label>
            <label class="option-label">
              <input type="radio" name="question-1" value="B" class="option-radio">
              <span class="option-text">B) To provide lighting for the work area</span>
            </label>
            <label class="option-label">
              <input type="radio" name="question-1" value="C" class="option-radio">
              <span class="option-text">C) To measure system temperature</span>
            </label>
            <label class="option-label">
              <input type="radio" name="question-1" value="D" class="option-radio">
              <span class="option-text">D) To control system power</span>
            </label>
          </div>
          <div class="question-actions">
            <button class="submit-question-btn" onclick="submitAnswer(1)">Submit Answer</button>
          </div>
          <div class="correct-answer" style="display: none; margin-top: 15px; padding: 15px; background: #1a2f1a; border-radius: 4px; border-left: 3px solid #4CAF50;">
            <strong style="color: #4CAF50;">Correct Answer:</strong> A) To indicate the system's condition and help quickly identify faults and safety issues for efficient maintenance.
          </div>
        </div>
        
        <div class="question-item" data-question="2">
          <h4>Question 2: What does a green Status LED indicate?</h4>
          <div class="multiple-choice-options">
            <label class="option-label">
              <input type="radio" name="question-2" value="A" class="option-radio">
              <span class="option-text">A) Green means the system is operating normally</span>
            </label>
            <label class="option-label">
              <input type="radio" name="question-2" value="B" class="option-radio">
              <span class="option-text">B) Green means there is a fault</span>
            </label>
            <label class="option-label">
              <input type="radio" name="question-2" value="C" class="option-radio">
              <span class="option-text">C) Green means the system is starting up</span>
            </label>
            <label class="option-label">
              <input type="radio" name="question-2" value="D" class="option-radio">
              <span class="option-text">D) Green means the system is shutting down</span>
            </label>
          </div>
          <div class="question-actions">
            <button class="submit-question-btn" onclick="submitAnswer(2)">Submit Answer</button>
          </div>
          <div class="correct-answer" style="display: none; margin-top: 15px; padding: 15px; background: #1a2f1a; border-radius: 4px; border-left: 3px solid #4CAF50;">
            <strong style="color: #4CAF50;">Correct Answer:</strong> C) Green means the system is starting up.
          </div>
        </div>
        
        <div class="question-item" data-question="3">
          <h4>Question 3: What colour does the LED turn when a fault is detected, but the system may still function?</h4>
          <div class="multiple-choice-options">
            <label class="option-label">
              <input type="radio" name="question-3" value="A" class="option-radio">
              <span class="option-text">A) Orange, it signals a fault that needs investigation</span>
            </label>
            <label class="option-label">
              <input type="radio" name="question-3" value="B" class="option-radio">
              <span class="option-text">B) Red, it signals a critical fault</span>
            </label>
            <label class="option-label">
              <input type="radio" name="question-3" value="C" class="option-radio">
              <span class="option-text">C) Blue, it signals normal operation</span>
            </label>
            <label class="option-label">
              <input type="radio" name="question-3" value="D" class="option-radio">
              <span class="option-text">D) Yellow, it signals the system is starting</span>
            </label>
          </div>
          <div class="question-actions">
            <button class="submit-question-btn" onclick="submitAnswer(3)">Submit Answer</button>
          </div>
          <div class="correct-answer" style="display: none; margin-top: 15px; padding: 15px; background: #1a2f1a; border-radius: 4px; border-left: 3px solid #4CAF50;">
            <strong style="color: #4CAF50;">Correct Answer:</strong> B) Red, it signals a critical fault.
          </div>
        </div>
        
        <div class="question-item" data-question="4">
          <h4>Question 4: How can you trigger a safety fault to observe the LED behaviour?</h4>
          <div class="multiple-choice-options">
            <label class="option-label">
              <input type="radio" name="question-4" value="A" class="option-radio">
              <span class="option-text">A) By pressing the Emergency Stop (E-Stop) to put the system into a safety error mode</span>
            </label>
            <label class="option-label">
              <input type="radio" name="question-4" value="B" class="option-radio">
              <span class="option-text">B) By turning off the main power</span>
            </label>
            <label class="option-label">
              <input type="radio" name="question-4" value="C" class="option-radio">
              <span class="option-text">C) By pressing the start button</span>
            </label>
            <label class="option-label">
              <input type="radio" name="question-4" value="D" class="option-radio">
              <span class="option-text">D) By adjusting the setpoint</span>
            </label>
          </div>
          <div class="question-actions">
            <button class="submit-question-btn" onclick="submitAnswer(4)">Submit Answer</button>
          </div>
          <div class="correct-answer" style="display: none; margin-top: 15px; padding: 15px; background: #1a2f1a; border-radius: 4px; border-left: 3px solid #4CAF50;">
            <strong style="color: #4CAF50;">Correct Answer:</strong> D) By adjusting the setpoint.
          </div>
        </div>
        
        <div class="question-item" data-question="5">
          <h4>Question 5: Why is it important to monitor the Status LED regularly?</h4>
          <div class="multiple-choice-options">
            <label class="option-label">
              <input type="radio" name="question-5" value="A" class="option-radio">
              <span class="option-text">A) Because it helps prevent downtime and ensures faults are addressed before escalating</span>
            </label>
            <label class="option-label">
              <input type="radio" name="question-5" value="B" class="option-radio">
              <span class="option-text">B) Because it saves energy</span>
            </label>
            <label class="option-label">
              <input type="radio" name="question-5" value="C" class="option-radio">
              <span class="option-text">C) Because it makes the system look better</span>
            </label>
            <label class="option-label">
              <input type="radio" name="question-5" value="D" class="option-radio">
              <span class="option-text">D) Because it is required by regulations</span>
            </label>
          </div>
          <div class="question-actions">
            <button class="submit-question-btn" onclick="submitAnswer(5)">Submit Answer</button>
          </div>
          <div class="correct-answer" style="display: none; margin-top: 15px; padding: 15px; background: #1a2f1a; border-radius: 4px; border-left: 3px solid #4CAF50;">
            <strong style="color: #4CAF50;">Correct Answer:</strong> B) Because it saves energy.
          </div>
        </div>
      </div>
    </div>

    <!-- Simulation Section -->
    <div class="simulation-section">
      <h2 class="section-header"><i class="fas fa-lightbulb"></i> 3. Interactive Status LED System</h2>
      
      <!-- Learning Guide -->
      <div class="simulation-container" style="margin-bottom: 25px;">
        <div style="background: linear-gradient(135deg, #1976D2, #1565C0); border-radius: 12px; padding: 25px; margin-bottom: 20px;">
          <h4 style="color: white; margin-bottom: 15px; font-size: 22px;">
            <i class="fas fa-graduation-cap"></i> Learning Objectives
          </h4>
          <div style="color: white; font-size: 18px; line-height: 1.6;">
            <p style="margin-bottom: 15px; font-size: 20px;"><strong>By the end of this simulation, you will be able to:</strong></p>
            <ul style="margin-left: 20px; margin-bottom: 0; font-size: 18px;">
              <li style="margin-bottom: 8px;">Identify different LED status indicators and their meanings</li>
              <li style="margin-bottom: 8px;">Recognize escalating fault conditions through LED behavior</li>
              <li style="margin-bottom: 8px;">Understand the relationship between system conditions and LED states</li>
              <li style="margin-bottom: 8px;">Practice troubleshooting using LED diagnostic information</li>
            </ul>
          </div>
        </div>
        
        <!-- Progress Tracker -->
        <div style="background: #2a2a2a; border-radius: 8px; padding: 20px; margin-bottom: 20px;">
          <h5 style="color: #FFFFFF; margin-bottom: 15px; font-size: 20px;">Progress Tracker</h5>
          <div id="progress-steps" style="display: grid; grid-template-columns: repeat(auto-fit, minmax(200px, 1fr)); gap: 15px;">
            <div class="progress-step active" data-step="1">
              <div style="display: flex; align-items: center; gap: 10px;">
                <div class="step-indicator" style="width: 30px; height: 30px; border-radius: 50%; background: #4CAF50; color: white; display: flex; align-items: center; justify-content: center; font-size: 16px; font-weight: bold;">1</div>
                <span style="color: #FFFFFF; font-size: 18px;">Basic LED States</span>
              </div>
            </div>
            <div class="progress-step" data-step="2">
              <div style="display: flex; align-items: center; gap: 10px;">
                <div class="step-indicator" style="width: 30px; height: 30px; border-radius: 50%; background: #666; color: white; display: flex; align-items: center; justify-content: center; font-size: 16px; font-weight: bold;">2</div>
                <span style="color: #AAA; font-size: 18px;">System Monitoring</span>
              </div>
            </div>
            <div class="progress-step" data-step="3">
              <div style="display: flex; align-items: center; gap: 10px;">
                <div class="step-indicator" style="width: 30px; height: 30px; border-radius: 50%; background: #666; color: white; display: flex; align-items: center; justify-content: center; font-size: 16px; font-weight: bold;">3</div>
                <span style="color: #AAA; font-size: 18px;">Fault Diagnosis</span>
              </div>
            </div>
            <div class="progress-step" data-step="4">
              <div style="display: flex; align-items: center; gap: 10px;">
                <div class="step-indicator" style="width: 30px; height: 30px; border-radius: 50%; background: #666; color: white; display: flex; align-items: center; justify-content: center; font-size: 16px; font-weight: bold;">4</div>
                <span style="color: #AAA; font-size: 18px;">Troubleshooting</span>
              </div>
            </div>
          </div>
        </div>
      </div>
      
      <!-- Step 1: Basic LED States -->
      <div id="step-1" class="learning-step active-step" style="margin-bottom: 25px;">
        <div class="simulation-container">
          <h4 style="color: #4CAF50; margin-bottom: 20px; font-size: 18px; display: flex; align-items: center; gap: 10px;">
            <i class="fas fa-play-circle"></i> Step 1: Basic LED States
          </h4>
          
          <div style="background: #2a2a2a; border-radius: 8px; padding: 20px; margin-bottom: 20px;">
            <p style="color: #FFFFFF; margin-bottom: 15px; font-size: 20px;">
              <strong>Learn the different LED states and their meanings:</strong>
            </p>
            <p style="color: #AAA; font-size: 18px; line-height: 1.5; margin-bottom: 0;">
              Status LEDs use different colors and patterns to communicate system status. Click each button below to see how the LED changes and learn what each state means.
            </p>
          </div>
          
          <div style="display: grid; grid-template-columns: 1fr 2fr; gap: 25px; align-items: start;">
            <!-- LED Display -->
            <div style="text-align: center;">
              <div class="led-display" style="background: #1a1a1a; border-radius: 12px; padding: 30px;">
                <div id="status-led" style="width: 100px; height: 100px; border-radius: 50%; margin: 0 auto 20px; border: 4px solid #555; background: #4CAF50; box-shadow: 0 0 30px rgba(76, 175, 80, 0.6); transition: all 0.5s ease;"></div>
                <div id="led-status-text" style="font-size: 24px; font-weight: bold; margin-bottom: 12px; color: #4CAF50;">Normal Operation</div>
                <div id="led-meaning-text" style="font-size: 18px; color: #AAA; line-height: 1.4;">All systems operating normally</div>
              </div>
            </div>
            
            <!-- Controls and Information -->
            <div>
              <div style="background: #1a1a1a; border-radius: 12px; padding: 20px; margin-bottom: 20px;">
                <h5 style="color: #FFFFFF; margin-bottom: 15px; font-size: 20px;">Try Different LED States:</h5>
                <div style="display: grid; grid-template-columns: repeat(auto-fit, minmax(140px, 1fr)); gap: 15px; margin-bottom: 20px;">
                  <button class="led-state-btn" data-state="green" style="background: linear-gradient(145deg, #4CAF50, #45A049); color: white; border: 2px solid #66BB6A; padding: 18px 12px; border-radius: 12px; cursor: pointer; font-weight: bold; font-size: 15px; transition: all 0.3s ease; box-shadow: 0 6px 12px rgba(76, 175, 80, 0.4), 0 3px 6px rgba(0,0,0,0.3); position: relative; overflow: hidden;" onmouseover="this.style.transform='translateY(-2px)'; this.style.boxShadow='0 8px 16px rgba(76, 175, 80, 0.5), 0 4px 8px rgba(0,0,0,0.4)'" onmouseout="this.style.transform='translateY(0)'; this.style.boxShadow='0 6px 12px rgba(76, 175, 80, 0.4), 0 3px 6px rgba(0,0,0,0.3)'" onmousedown="this.style.transform='translateY(1px)'" onmouseup="this.style.transform='translateY(-2px)'">
                    <i class="fas fa-circle" style="font-size: 16px; margin-bottom: 6px; display: block;"></i>NORMAL
                  </button>
                  <button class="led-state-btn" data-state="yellow" style="background: linear-gradient(145deg, #FF9800, #FB8C00); color: white; border: 2px solid #FFB74D; padding: 18px 12px; border-radius: 12px; cursor: pointer; font-weight: bold; font-size: 15px; transition: all 0.3s ease; box-shadow: 0 6px 12px rgba(255, 152, 0, 0.4), 0 3px 6px rgba(0,0,0,0.3); position: relative; overflow: hidden;" onmouseover="this.style.transform='translateY(-2px)'; this.style.boxShadow='0 8px 16px rgba(255, 152, 0, 0.5), 0 4px 8px rgba(0,0,0,0.4)'" onmouseout="this.style.transform='translateY(0)'; this.style.boxShadow='0 6px 12px rgba(255, 152, 0, 0.4), 0 3px 6px rgba(0,0,0,0.3)'" onmousedown="this.style.transform='translateY(1px)'" onmouseup="this.style.transform='translateY(-2px)'">
                    <i class="fas fa-exclamation-triangle" style="font-size: 16px; margin-bottom: 6px; display: block;"></i>WARNING
                  </button>
                  <button class="led-state-btn" data-state="red" style="background: linear-gradient(145deg, #F44336, #E53935); color: white; border: 2px solid #EF5350; padding: 18px 12px; border-radius: 12px; cursor: pointer; font-weight: bold; font-size: 15px; transition: all 0.3s ease; box-shadow: 0 6px 12px rgba(244, 67, 54, 0.4), 0 3px 6px rgba(0,0,0,0.3); position: relative; overflow: hidden;" onmouseover="this.style.transform='translateY(-2px)'; this.style.boxShadow='0 8px 16px rgba(244, 67, 54, 0.5), 0 4px 8px rgba(0,0,0,0.4)'" onmouseout="this.style.transform='translateY(0)'; this.style.boxShadow='0 6px 12px rgba(244, 67, 54, 0.4), 0 3px 6px rgba(0,0,0,0.3)'" onmousedown="this.style.transform='translateY(1px)'" onmouseup="this.style.transform='translateY(-2px)'">
                    <i class="fas fa-times-circle" style="font-size: 16px; margin-bottom: 6px; display: block;"></i>FAULT
                  </button>
                  <button class="led-state-btn" data-state="flashing-yellow" style="background: linear-gradient(145deg, #FF9800, #F57C00); color: white; border: 2px solid #FFB74D; padding: 18px 12px; border-radius: 12px; cursor: pointer; font-weight: bold; font-size: 15px; transition: all 0.3s ease; box-shadow: 0 6px 12px rgba(255, 152, 0, 0.4), 0 3px 6px rgba(0,0,0,0.3); position: relative; overflow: hidden;" onmouseover="this.style.transform='translateY(-2px)'; this.style.boxShadow='0 8px 16px rgba(255, 152, 0, 0.5), 0 4px 8px rgba(0,0,0,0.4)'" onmouseout="this.style.transform='translateY(0)'; this.style.boxShadow='0 6px 12px rgba(255, 152, 0, 0.4), 0 3px 6px rgba(0,0,0,0.3)'" onmousedown="this.style.transform='translateY(1px)'" onmouseup="this.style.transform='translateY(-2px)'">
                    <i class="fas fa-exclamation" style="font-size: 16px; margin-bottom: 6px; display: block;"></i>URGENT
                  </button>
                  <button class="led-state-btn" data-state="flashing-red" style="background: linear-gradient(145deg, #F44336, #C62828); color: white; border: 2px solid #EF5350; padding: 18px 12px; border-radius: 12px; cursor: pointer; font-weight: bold; font-size: 15px; transition: all 0.3s ease; box-shadow: 0 6px 12px rgba(244, 67, 54, 0.4), 0 3px 6px rgba(0,0,0,0.3); position: relative; overflow: hidden;" onmouseover="this.style.transform='translateY(-2px)'; this.style.boxShadow='0 8px 16px rgba(244, 67, 54, 0.5), 0 4px 8px rgba(0,0,0,0.4)'" onmouseout="this.style.transform='translateY(0)'; this.style.boxShadow='0 6px 12px rgba(244, 67, 54, 0.4), 0 3px 6px rgba(0,0,0,0.3)'" onmousedown="this.style.transform='translateY(1px)'" onmouseup="this.style.transform='translateY(-2px)'">
                    <i class="fas fa-skull-crossbones" style="font-size: 16px; margin-bottom: 6px; display: block;"></i>CRITICAL
                  </button>
                  <button class="led-state-btn" data-state="off" style="background: linear-gradient(145deg, #424242, #303030); color: #AAA; border: 2px solid #616161; padding: 18px 12px; border-radius: 12px; cursor: pointer; font-weight: bold; font-size: 15px; transition: all 0.3s ease; box-shadow: 0 6px 12px rgba(66, 66, 66, 0.4), 0 3px 6px rgba(0,0,0,0.3); position: relative; overflow: hidden;" onmouseover="this.style.transform='translateY(-2px)'; this.style.boxShadow='0 8px 16px rgba(66, 66, 66, 0.5), 0 4px 8px rgba(0,0,0,0.4)'" onmouseout="this.style.transform='translateY(0)'; this.style.boxShadow='0 6px 12px rgba(66, 66, 66, 0.4), 0 3px 6px rgba(0,0,0,0.3)'" onmousedown="this.style.transform='translateY(1px)'" onmouseup="this.style.transform='translateY(-2px)'">
                    <i class="fas fa-power-off" style="font-size: 16px; margin-bottom: 6px; display: block;"></i>OFF
                  </button>
                </div>
                
                <!-- LED State Reference -->
                <div id="led-reference" style="background: #333; border-radius: 8px; padding: 15px;">
                  <h6 style="color: #FFFFFF; margin-bottom: 10px; font-size: 18px;">LED State Reference:</h6>
                  <div style="font-size: 16px; color: #AAA; line-height: 1.5;">
                    <div style="margin-bottom: 8px;">🟢 <strong>Green:</strong> Normal operation, all systems OK</div>
                    <div style="margin-bottom: 8px;">🟡 <strong>Yellow:</strong> Warning condition, attention needed</div>
                    <div style="margin-bottom: 8px;">🔴 <strong>Red:</strong> Fault condition, immediate action required</div>
                    <div style="margin-bottom: 8px;">🟡 <strong>Flashing Yellow:</strong> Escalating warning, urgent attention</div>
                    <div style="margin-bottom: 8px;">🔴 <strong>Flashing Red:</strong> Critical fault, system shutdown imminent</div>
                    <div>⚫ <strong>Off:</strong> No power or system shutdown</div>
                  </div>
                </div>
              </div>
              
              <button id="complete-step-1" class="next-step-btn" style="background: linear-gradient(145deg, #4CAF50, #45A049); color: white; border: 2px solid #66BB6A; padding: 18px 25px; border-radius: 12px; cursor: pointer; font-weight: bold; font-size: 16px; width: 100%; box-shadow: 0 6px 12px rgba(76, 175, 80, 0.4), 0 3px 6px rgba(0,0,0,0.3); transition: all 0.3s ease;" disabled onmouseover="if(!this.disabled) { this.style.transform='translateY(-2px)'; this.style.boxShadow='0 8px 16px rgba(76, 175, 80, 0.5), 0 4px 8px rgba(0,0,0,0.4)'; }" onmouseout="this.style.transform='translateY(0)'; this.style.boxShadow='0 6px 12px rgba(76, 175, 80, 0.4), 0 3px 6px rgba(0,0,0,0.3)';" onmousedown="if(!this.disabled) this.style.transform='translateY(1px)'" onmouseup="if(!this.disabled) this.style.transform='translateY(-2px)'">
                <i class="fas fa-check"></i> Complete Step 1 - Continue to System Monitoring
              </button>
            </div>
          </div>
        </div>
      </div>
      
      <!-- Step 2: System Monitoring -->
      <div id="step-2" class="learning-step" style="margin-bottom: 25px; display: none;">
        <div class="simulation-container">
          <h4 style="color: #FF9800; margin-bottom: 20px; font-size: 18px; display: flex; align-items: center; gap: 10px;">
            <i class="fas fa-chart-line"></i> Step 2: System Monitoring
          </h4>
          
          <div style="background: #2a2a2a; border-radius: 8px; padding: 20px; margin-bottom: 20px;">
            <p style="color: #FFFFFF; margin-bottom: 15px; font-size: 20px;">
              <strong>Learn how system conditions affect LED status:</strong>
            </p>
            <p style="color: #AAA; font-size: 18px; line-height: 1.5; margin-bottom: 0;">
              The LED status is determined by various system parameters. Watch how the LED changes as you adjust different system conditions.
            </p>
          </div>
          
          <div style="display: grid; grid-template-columns: 1fr 1fr; gap: 25px;">
            <!-- System Parameters -->
            <div style="background: #1a1a1a; border-radius: 12px; padding: 20px;">
              <h5 style="color: #FFFFFF; margin-bottom: 20px;">System Parameters:</h5>
              
              <div class="parameter-control" style="margin-bottom: 20px;">
                <label style="color: #FFFFFF; font-size: 14px; margin-bottom: 8px; display: block;">Temperature: <span id="temp-value">75°C</span></label>
                <input type="range" id="temperature-slider" min="50" max="120" value="75" style="width: 100%; margin-bottom: 8px;">
                <div style="font-size: 12px; color: #AAA;">Normal: 70-85°C | Warning: 85-100°C | Fault: >100°C</div>
              </div>
              
              <div class="parameter-control" style="margin-bottom: 20px;">
                <label style="color: #FFFFFF; font-size: 14px; margin-bottom: 8px; display: block;">Pressure: <span id="pressure-value">2.5 bar</span></label>
                <input type="range" id="pressure-slider" min="0" max="5" step="0.1" value="2.5" style="width: 100%; margin-bottom: 8px;">
                <div style="font-size: 12px; color: #AAA;">Normal: 2.0-3.0 bar | Warning: 1.5-2.0 or 3.0-3.5 | Fault: <1.5 or >3.5</div>
              </div>
              
              <div class="parameter-control" style="margin-bottom: 20px;">
                <label style="color: #FFFFFF; font-size: 14px; margin-bottom: 8px; display: block;">Flow Rate: <span id="flow-value">150 L/min</span></label>
                <input type="range" id="flow-slider" min="0" max="300" value="150" style="width: 100%; margin-bottom: 8px;">
                <div style="font-size: 12px; color: #AAA;">Normal: 120-180 L/min | Warning: 90-120 or 180-220 | Fault: <90 or >220</div>
              </div>
              
              <button id="auto-monitor" style="background: linear-gradient(145deg, #2196F3, #1976D2); color: white; border: 2px solid #42A5F5; padding: 15px 20px; border-radius: 10px; cursor: pointer; font-weight: bold; width: 100%; box-shadow: 0 6px 12px rgba(33, 150, 243, 0.4), 0 3px 6px rgba(0,0,0,0.3); transition: all 0.3s ease; font-size: 15px;" onmouseover="this.style.transform='translateY(-2px)'; this.style.boxShadow='0 8px 16px rgba(33, 150, 243, 0.5), 0 4px 8px rgba(0,0,0,0.4)'" onmouseout="this.style.transform='translateY(0)'; this.style.boxShadow='0 6px 12px rgba(33, 150, 243, 0.4), 0 3px 6px rgba(0,0,0,0.3)'" onmousedown="this.style.transform='translateY(1px)'" onmouseup="this.style.transform='translateY(-2px)'">
                <i class="fas fa-play"></i> Start Auto Monitoring
              </button>
            </div>
            
            <!-- LED and System Status -->
            <div style="background: #1a1a1a; border-radius: 12px; padding: 20px;">
              <div style="text-align: center; margin-bottom: 20px;">
                <div id="monitor-led" style="width: 80px; height: 80px; border-radius: 50%; margin: 0 auto 15px; border: 4px solid #555; background: #4CAF50; box-shadow: 0 0 25px rgba(76, 175, 80, 0.6); transition: all 0.5s ease;"></div>
                <div id="monitor-status-text" style="font-size: 18px; font-weight: bold; margin-bottom: 8px; color: #4CAF50;">Normal Operation</div>
                <div id="monitor-meaning-text" style="font-size: 14px; color: #AAA;">All parameters within normal range</div>
              </div>
              
              <div style="background: #333; border-radius: 8px; padding: 15px;">
                <h6 style="color: #FFFFFF; margin-bottom: 10px;">System Health:</h6>
                <div id="system-health-details" style="font-size: 12px; color: #AAA; line-height: 1.5;">
                  <div>🌡️ Temperature: Normal</div>
                  <div>📊 Pressure: Normal</div>
                  <div>💧 Flow Rate: Normal</div>
                  <div style="margin-top: 10px; color: #4CAF50; font-weight: bold;">Overall Status: All Systems Normal</div>
                </div>
              </div>
            </div>
          </div>
          
          <button id="complete-step-2" class="next-step-btn" style="background: linear-gradient(145deg, #FF9800, #FB8C00); color: white; border: 2px solid #FFB74D; padding: 18px 25px; border-radius: 12px; cursor: pointer; font-weight: bold; font-size: 16px; width: 100%; margin-top: 20px; box-shadow: 0 6px 12px rgba(255, 152, 0, 0.4), 0 3px 6px rgba(0,0,0,0.3); transition: all 0.3s ease;" disabled onmouseover="if(!this.disabled) { this.style.transform='translateY(-2px)'; this.style.boxShadow='0 8px 16px rgba(255, 152, 0, 0.5), 0 4px 8px rgba(0,0,0,0.4)'; }" onmouseout="this.style.transform='translateY(0)'; this.style.boxShadow='0 6px 12px rgba(255, 152, 0, 0.4), 0 3px 6px rgba(0,0,0,0.3)';" onmousedown="if(!this.disabled) this.style.transform='translateY(1px)'" onmouseup="if(!this.disabled) this.style.transform='translateY(-2px)'">
            <i class="fas fa-check"></i> Complete Step 2 - Continue to Fault Diagnosis
          </button>
        </div>
      </div>
      
      <!-- Step 3: Fault Diagnosis -->
      <div id="step-3" class="learning-step" style="margin-bottom: 25px; display: none;">
        <div class="simulation-container">
          <h4 style="color: #F44336; margin-bottom: 20px; font-size: 18px; display: flex; align-items: center; gap: 10px;">
            <i class="fas fa-search"></i> Step 3: Fault Diagnosis Practice
          </h4>
          
          <div style="background: #2a2a2a; border-radius: 8px; padding: 20px; margin-bottom: 20px;">
            <p style="color: #FFFFFF; margin-bottom: 15px; font-size: 20px;">
              <strong>Practice diagnosing faults using LED indicators:</strong>
            </p>
            <p style="color: #AAA; font-size: 18px; line-height: 1.5; margin-bottom: 0;">
              Different faults create specific LED patterns. Practice identifying common fault types and their corresponding LED behaviors.
            </p>
          </div>
          
          <div style="display: grid; grid-template-columns: 1fr 1fr; gap: 25px;">
            <!-- Fault Scenarios -->
            <div style="background: #1a1a1a; border-radius: 12px; padding: 20px;">
              <h5 style="color: #FFFFFF; margin-bottom: 20px;">Fault Scenarios:</h5>
              
              <div style="display: grid; gap: 15px; margin-bottom: 20px;">
                <button class="fault-scenario-btn" data-fault="high-temp" style="background: linear-gradient(145deg, #FF5722, #E64A19); color: white; border: 2px solid #FF7043; padding: 16px 15px; border-radius: 10px; cursor: pointer; font-weight: bold; text-align: left; box-shadow: 0 4px 8px rgba(255, 87, 34, 0.3), 0 2px 4px rgba(0,0,0,0.2); transition: all 0.3s ease;" onmouseover="this.style.transform='translateY(-1px)'; this.style.boxShadow='0 6px 12px rgba(255, 87, 34, 0.4), 0 3px 6px rgba(0,0,0,0.3)'" onmouseout="this.style.transform='translateY(0)'; this.style.boxShadow='0 4px 8px rgba(255, 87, 34, 0.3), 0 2px 4px rgba(0,0,0,0.2)'" onmousedown="this.style.transform='translateY(1px)'" onmouseup="this.style.transform='translateY(-1px)'">
                  <i class="fas fa-thermometer-full" style="margin-right: 8px;"></i> High Temperature Alert
                </button>
                <button class="fault-scenario-btn" data-fault="low-pressure" style="background: linear-gradient(145deg, #FF9800, #FB8C00); color: white; border: 2px solid #FFB74D; padding: 16px 15px; border-radius: 10px; cursor: pointer; font-weight: bold; text-align: left; box-shadow: 0 4px 8px rgba(255, 152, 0, 0.3), 0 2px 4px rgba(0,0,0,0.2); transition: all 0.3s ease;" onmouseover="this.style.transform='translateY(-1px)'; this.style.boxShadow='0 6px 12px rgba(255, 152, 0, 0.4), 0 3px 6px rgba(0,0,0,0.3)'" onmouseout="this.style.transform='translateY(0)'; this.style.boxShadow='0 4px 8px rgba(255, 152, 0, 0.3), 0 2px 4px rgba(0,0,0,0.2)'" onmousedown="this.style.transform='translateY(1px)'" onmouseup="this.style.transform='translateY(-1px)'">
                  <i class="fas fa-tachometer-alt" style="margin-right: 8px;"></i> Low Pressure Warning
                </button>
                <button class="fault-scenario-btn" data-fault="pump-failure" style="background: linear-gradient(145deg, #F44336, #E53935); color: white; border: 2px solid #EF5350; padding: 16px 15px; border-radius: 10px; cursor: pointer; font-weight: bold; text-align: left; box-shadow: 0 4px 8px rgba(244, 67, 54, 0.3), 0 2px 4px rgba(0,0,0,0.2); transition: all 0.3s ease;" onmouseover="this.style.transform='translateY(-1px)'; this.style.boxShadow='0 6px 12px rgba(244, 67, 54, 0.4), 0 3px 6px rgba(0,0,0,0.3)'" onmouseout="this.style.transform='translateY(0)'; this.style.boxShadow='0 4px 8px rgba(244, 67, 54, 0.3), 0 2px 4px rgba(0,0,0,0.2)'" onmousedown="this.style.transform='translateY(1px)'" onmouseup="this.style.transform='translateY(-1px)'">
                  <i class="fas fa-cog" style="margin-right: 8px;"></i> Pump Failure Critical
                </button>
                <button class="fault-scenario-btn" data-fault="sensor-drift" style="background: linear-gradient(145deg, #FF9800, #F57C00); color: white; border: 2px solid #FFB74D; padding: 16px 15px; border-radius: 10px; cursor: pointer; font-weight: bold; text-align: left; box-shadow: 0 4px 8px rgba(255, 152, 0, 0.3), 0 2px 4px rgba(0,0,0,0.2); transition: all 0.3s ease;" onmouseover="this.style.transform='translateY(-1px)'; this.style.boxShadow='0 6px 12px rgba(255, 152, 0, 0.4), 0 3px 6px rgba(0,0,0,0.3)'" onmouseout="this.style.transform='translateY(0)'; this.style.boxShadow='0 4px 8px rgba(255, 152, 0, 0.3), 0 2px 4px rgba(0,0,0,0.2)'" onmousedown="this.style.transform='translateY(1px)'" onmouseup="this.style.transform='translateY(-1px)'">
                  <i class="fas fa-exclamation-triangle" style="margin-right: 8px;"></i> Sensor Drift
                </button>
                <button class="fault-scenario-btn" data-fault="comm-loss" style="background: linear-gradient(145deg, #9C27B0, #8E24AA); color: white; border: 2px solid #BA68C8; padding: 16px 15px; border-radius: 10px; cursor: pointer; font-weight: bold; text-align: left; box-shadow: 0 4px 8px rgba(156, 39, 176, 0.3), 0 2px 4px rgba(0,0,0,0.2); transition: all 0.3s ease;" onmouseover="this.style.transform='translateY(-1px)'; this.style.boxShadow='0 6px 12px rgba(156, 39, 176, 0.4), 0 3px 6px rgba(0,0,0,0.3)'" onmouseout="this.style.transform='translateY(0)'; this.style.boxShadow='0 4px 8px rgba(156, 39, 176, 0.3), 0 2px 4px rgba(0,0,0,0.2)'" onmousedown="this.style.transform='translateY(1px)'" onmouseup="this.style.transform='translateY(-1px)'">
                  <i class="fas fa-wifi" style="margin-right: 8px;"></i> Communication Loss
                </button>
              </div>
              
              <button id="clear-faults" style="background: linear-gradient(145deg, #4CAF50, #45A049); color: white; border: 2px solid #66BB6A; padding: 16px 20px; border-radius: 10px; cursor: pointer; font-weight: bold; width: 100%; box-shadow: 0 4px 8px rgba(76, 175, 80, 0.3), 0 2px 4px rgba(0,0,0,0.2); transition: all 0.3s ease; font-size: 15px;" onmouseover="this.style.transform='translateY(-1px)'; this.style.boxShadow='0 6px 12px rgba(76, 175, 80, 0.4), 0 3px 6px rgba(0,0,0,0.3)'" onmouseout="this.style.transform='translateY(0)'; this.style.boxShadow='0 4px 8px rgba(76, 175, 80, 0.3), 0 2px 4px rgba(0,0,0,0.2)'" onmousedown="this.style.transform='translateY(1px)'" onmouseup="this.style.transform='translateY(-1px)'">
                <i class="fas fa-undo" style="margin-right: 8px;"></i> Clear All Faults
              </button>
            </div>
            
            <!-- Diagnosis Area -->
            <div style="background: #1a1a1a; border-radius: 12px; padding: 20px;">
              <div style="text-align: center; margin-bottom: 20px;">
                <div id="diagnosis-led" style="width: 80px; height: 80px; border-radius: 50%; margin: 0 auto 15px; border: 4px solid #555; background: #4CAF50; box-shadow: 0 0 25px rgba(76, 175, 80, 0.6); transition: all 0.5s ease;"></div>
                <div id="diagnosis-status-text" style="font-size: 18px; font-weight: bold; margin-bottom: 8px; color: #4CAF50;">Normal Operation</div>
                <div id="diagnosis-meaning-text" style="font-size: 14px; color: #AAA;">No active faults detected</div>
              </div>
              
              <div style="background: #333; border-radius: 8px; padding: 15px; margin-bottom: 15px;">
                <h6 style="color: #FFFFFF; margin-bottom: 10px;">Active Faults:</h6>
                <div id="active-faults-list" style="font-size: 12px; color: #AAA; line-height: 1.5;">
                  No active faults
                </div>
              </div>
              
              <div style="background: #333; border-radius: 8px; padding: 15px;">
                <h6 style="color: #FFFFFF; margin-bottom: 10px;">Diagnostic Information:</h6>
                <div id="diagnostic-info" style="font-size: 12px; color: #AAA; line-height: 1.5;">
                  Click a fault scenario to see how the LED responds and practice fault identification.
                </div>
              </div>
            </div>
          </div>
          
          <button id="complete-step-3" class="next-step-btn" style="background: linear-gradient(145deg, #F44336, #E53935); color: white; border: 2px solid #EF5350; padding: 18px 25px; border-radius: 12px; cursor: pointer; font-weight: bold; font-size: 16px; width: 100%; margin-top: 20px; box-shadow: 0 6px 12px rgba(244, 67, 54, 0.4), 0 3px 6px rgba(0,0,0,0.3); transition: all 0.3s ease;" disabled onmouseover="if(!this.disabled) { this.style.transform='translateY(-2px)'; this.style.boxShadow='0 8px 16px rgba(244, 67, 54, 0.5), 0 4px 8px rgba(0,0,0,0.4)'; }" onmouseout="this.style.transform='translateY(0)'; this.style.boxShadow='0 6px 12px rgba(244, 67, 54, 0.4), 0 3px 6px rgba(0,0,0,0.3)';" onmousedown="if(!this.disabled) this.style.transform='translateY(1px)'" onmouseup="if(!this.disabled) this.style.transform='translateY(-2px)'">
            <i class="fas fa-check"></i> Complete Step 3 - Continue to Troubleshooting
          </button>
        </div>
      </div>
      
      <!-- Step 4: Troubleshooting Challenge -->
      <div id="step-4" class="learning-step" style="margin-bottom: 25px; display: none;">
        <div class="simulation-container">
          <h4 style="color: #9C27B0; margin-bottom: 20px; font-size: 18px; display: flex; align-items: center; gap: 10px;">
            <i class="fas fa-tools"></i> Step 4: Troubleshooting Challenge
          </h4>
          
          <div style="background: #2a2a2a; border-radius: 8px; padding: 20px; margin-bottom: 20px;">
            <p style="color: #FFFFFF; margin-bottom: 15px; font-size: 20px;">
              <strong>Put your knowledge to the test:</strong>
            </p>
            <p style="color: #AAA; font-size: 18px; line-height: 1.5; margin-bottom: 0;">
              Complete this troubleshooting challenge by correctly identifying LED states and recommending appropriate actions based on the scenarios presented.
            </p>
          </div>
          
          <div id="challenge-container">
            <!-- Challenge content will be generated here -->
          </div>
          
          <button id="complete-step-4" class="next-step-btn" style="background: linear-gradient(145deg, #9C27B0, #8E24AA); color: white; border: 2px solid #BA68C8; padding: 18px 25px; border-radius: 12px; cursor: pointer; font-weight: bold; font-size: 16px; width: 100%; margin-top: 20px; box-shadow: 0 6px 12px rgba(156, 39, 176, 0.4), 0 3px 6px rgba(0,0,0,0.3); transition: all 0.3s ease;" disabled onmouseover="if(!this.disabled) { this.style.transform='translateY(-2px)'; this.style.boxShadow='0 8px 16px rgba(156, 39, 176, 0.5), 0 4px 8px rgba(0,0,0,0.4)'; }" onmouseout="this.style.transform='translateY(0)'; this.style.boxShadow='0 6px 12px rgba(156, 39, 176, 0.4), 0 3px 6px rgba(0,0,0,0.3)';" onmousedown="if(!this.disabled) this.style.transform='translateY(1px)'" onmouseup="if(!this.disabled) this.style.transform='translateY(-2px)'">
            <i class="fas fa-trophy"></i> Complete All Steps - Simulation Finished!
          </button>
        </div>
      </div>
    </div>
  </div>


    

    

    


  <!-- Scripts -->
  <script src="https://cdnjs.cloudflare.com/ajax/libs/jquery/3.7.1/jquery.min.js"></script>
  <script src="status-led-simulation.js"></script>
  
  <script>
    // Enhanced Status LED Simulation with Progressive Learning
    let currentStep = 1;
    let completedSteps = [];
    let statesExplored = [];
    let parametersAdjusted = [];
    let faultsExplored = [];
    let flashingIntervals = {};
    
    document.addEventListener('DOMContentLoaded', function() {
      initializeEnhancedSimulation();
      loadSavedAnswers();
    });
    
    function initializeEnhancedSimulation() {
      console.log('Initializing Enhanced Status LED Simulation...');
      
      // Initialize Step 1 - Basic LED States
      initializeStep1();
      
      // Initialize progress tracking
      updateProgressTracker();
    }
    
    function initializeStep1() {
      console.log('Initializing Step 1 - Basic LED States');
      
      // Add event listeners for LED state buttons
      document.querySelectorAll('.led-state-btn').forEach(btn => {
        btn.addEventListener('click', function() {
          const state = this.getAttribute('data-state');
          setLEDState('status-led', 'led-status-text', 'led-meaning-text', state);
          
          // Track explored states
          if (!statesExplored.includes(state)) {
            statesExplored.push(state);
            
            // Visual feedback for button
            this.style.border = '2px solid #4CAF50';
            this.style.transform = 'scale(0.95)';
            setTimeout(() => {
              this.style.transform = 'scale(1)';
            }, 150);
          }
          
          // Check if all states have been explored
          checkStep1Completion();
        });
      });
      
      // Complete step 1 button
      document.getElementById('complete-step-1').addEventListener('click', function() {
        completeStep(1);
        showStep(2);
        initializeStep2();
      });
    }
    
    function initializeStep2() {
      console.log('Initializing Step 2 - System Monitoring');
      
      // Parameter sliders
      const tempSlider = document.getElementById('temperature-slider');
      const pressureSlider = document.getElementById('pressure-slider');
      const flowSlider = document.getElementById('flow-slider');
      
      tempSlider.addEventListener('input', function() {
        const value = this.value;
        document.getElementById('temp-value').textContent = value + '°C';
        trackParameterAdjustment('temperature');
        updateSystemStatus();
      });
      
      pressureSlider.addEventListener('input', function() {
        const value = this.value;
        document.getElementById('pressure-value').textContent = value + ' bar';
        trackParameterAdjustment('pressure');
        updateSystemStatus();
      });
      
      flowSlider.addEventListener('input', function() {
        const value = this.value;
        document.getElementById('flow-value').textContent = value + ' L/min';
        trackParameterAdjustment('flow');
        updateSystemStatus();
      });
      
      // Auto monitor button
      document.getElementById('auto-monitor').addEventListener('click', function() {
        startAutoMonitoring();
      });
      
      // Complete step 2 button
      document.getElementById('complete-step-2').addEventListener('click', function() {
        completeStep(2);
        showStep(3);
        initializeStep3();
      });
    }
    
    function initializeStep3() {
      console.log('Initializing Step 3 - Fault Diagnosis');
      
      // Fault scenario buttons
      document.querySelectorAll('.fault-scenario-btn').forEach(btn => {
        btn.addEventListener('click', function() {
          const fault = this.getAttribute('data-fault');
          injectFaultScenario(fault);
          
          // Track explored faults
          if (!faultsExplored.includes(fault)) {
            faultsExplored.push(fault);
            
            // Visual feedback
            this.style.border = '2px solid #4CAF50';
          }
          
          checkStep3Completion();
        });
      });
      
      // Clear faults button
      document.getElementById('clear-faults').addEventListener('click', function() {
        clearAllFaults();
      });
      
      // Complete step 3 button
      document.getElementById('complete-step-3').addEventListener('click', function() {
        completeStep(3);
        showStep(4);
        initializeStep4();
      });
    }
    
    function initializeStep4() {
      console.log('Initializing Step 4 - Troubleshooting Challenge');
      
      generateTroubleshootingChallenge();
      
      // Complete step 4 button
      document.getElementById('complete-step-4').addEventListener('click', function() {
        completeStep(4);
        showCompletionMessage();
      });
    }
    
    // LED State Management
    function setLEDState(ledId, statusId, meaningId, state) {
      const led = document.getElementById(ledId);
      const statusText = document.getElementById(statusId);
      const meaningText = document.getElementById(meaningId);
      
      if (!led || !statusText || !meaningText) return;
      
      // Clear any existing flashing
      if (flashingIntervals[ledId]) {
        clearInterval(flashingIntervals[ledId]);
        delete flashingIntervals[ledId];
      }
      
      const states = {
        'off': { color: '#333', glow: 'none', description: 'System Off', meaning: 'No power or system shutdown' },
        'green': { color: '#4CAF50', glow: '0 0 30px rgba(76, 175, 80, 0.6)', description: 'Normal Operation', meaning: 'All systems operating normally' },
        'yellow': { color: '#FF9800', glow: '0 0 30px rgba(255, 152, 0, 0.6)', description: 'Warning', meaning: 'Minor fault detected, attention required' },
        'red': { color: '#F44336', glow: '0 0 30px rgba(244, 67, 54, 0.6)', description: 'Fault', meaning: 'Critical fault, immediate action required' },
        'flashing-yellow': { color: '#FF9800', glow: '0 0 30px rgba(255, 152, 0, 0.6)', description: 'Warning - Flashing', meaning: 'Warning condition escalating, urgent attention needed' },
        'flashing-red': { color: '#F44336', glow: '0 0 30px rgba(244, 67, 54, 0.6)', description: 'Critical Fault - Flashing', meaning: 'Critical fault, system shutdown imminent' }
      };
      
      const stateConfig = states[state] || states['green'];
      
      if (state.startsWith('flashing-')) {
        // Implement flashing
        let isOn = true;
        flashingIntervals[ledId] = setInterval(() => {
          if (isOn) {
            led.style.background = stateConfig.color;
            led.style.boxShadow = stateConfig.glow;
          } else {
            led.style.background = '#333';
            led.style.boxShadow = 'none';
          }
          isOn = !isOn;
        }, 500);
      } else {
        led.style.background = stateConfig.color;
        led.style.boxShadow = stateConfig.glow;
      }
      
      statusText.textContent = stateConfig.description;
      statusText.style.color = stateConfig.color;
      meaningText.textContent = stateConfig.meaning;
    }
    
    // Step Management
    function showStep(stepNumber) {
      // Hide all steps
      document.querySelectorAll('.learning-step').forEach(step => {
        step.style.display = 'none';
      });
      
      // Show target step
      const targetStep = document.getElementById(`step-${stepNumber}`);
      if (targetStep) {
        targetStep.style.display = 'block';
        currentStep = stepNumber;
        updateProgressTracker();
      }
    }
    
    function completeStep(stepNumber) {
      if (!completedSteps.includes(stepNumber)) {
        completedSteps.push(stepNumber);
        updateProgressTracker();
      }
    }
    
    function updateProgressTracker() {
      document.querySelectorAll('.progress-step').forEach((step, index) => {
        const stepNumber = index + 1;
        const indicator = step.querySelector('.step-indicator');
        const text = step.querySelector('span');
        
                 if (completedSteps.includes(stepNumber)) {
           // Completed step
           indicator.style.background = '#4CAF50';
           indicator.innerHTML = '<i class="fas fa-check" style="font-size: 14px;"></i>';
           text.style.color = '#4CAF50';
           step.classList.add('completed');
         } else if (stepNumber === currentStep) {
           // Current step
           indicator.style.background = '#2196F3';
           indicator.textContent = stepNumber;
           indicator.style.fontSize = '16px';
           text.style.color = '#FFFFFF';
           text.style.fontSize = '18px';
           step.classList.add('active');
         } else {
           // Future step
           indicator.style.background = '#666';
           indicator.textContent = stepNumber;
           indicator.style.fontSize = '16px';
           text.style.color = '#AAA';
           text.style.fontSize = '18px';
           step.classList.remove('active', 'completed');
         }
      });
    }
    
    function checkStep1Completion() {
      const requiredStates = ['green', 'yellow', 'red', 'flashing-yellow', 'flashing-red', 'off'];
      const allExplored = requiredStates.every(state => statesExplored.includes(state));
      
      const completeBtn = document.getElementById('complete-step-1');
      if (allExplored) {
        completeBtn.disabled = false;
        completeBtn.style.background = '#4CAF50';
        completeBtn.innerHTML = '<i class="fas fa-check"></i> Well Done! Continue to System Monitoring';
      }
    }
    
    // System Monitoring Functions
    function trackParameterAdjustment(parameter) {
      if (!parametersAdjusted.includes(parameter)) {
        parametersAdjusted.push(parameter);
        checkStep2Completion();
      }
    }
    
    function updateSystemStatus() {
      const temp = parseFloat(document.getElementById('temperature-slider').value);
      const pressure = parseFloat(document.getElementById('pressure-slider').value);
      const flow = parseFloat(document.getElementById('flow-slider').value);
      
      let worstCondition = 'green';
      let statusDetails = [];
      
      // Temperature analysis
      if (temp > 100) {
        worstCondition = 'red';
        statusDetails.push('🌡️ Temperature: FAULT (Critical High)');
      } else if (temp > 85) {
        if (worstCondition === 'green') worstCondition = 'yellow';
        statusDetails.push('🌡️ Temperature: WARNING (High)');
      } else if (temp < 60) {
        if (worstCondition === 'green') worstCondition = 'yellow';
        statusDetails.push('🌡️ Temperature: WARNING (Low)');
      } else {
        statusDetails.push('🌡️ Temperature: Normal');
      }
      
      // Pressure analysis
      if (pressure < 1.5 || pressure > 3.5) {
        worstCondition = 'red';
        statusDetails.push('📊 Pressure: FAULT (Out of Range)');
      } else if (pressure < 2.0 || pressure > 3.0) {
        if (worstCondition === 'green') worstCondition = 'yellow';
        statusDetails.push('📊 Pressure: WARNING (Near Limits)');
      } else {
        statusDetails.push('📊 Pressure: Normal');
      }
      
      // Flow analysis
      if (flow < 90 || flow > 220) {
        worstCondition = 'red';
        statusDetails.push('💧 Flow Rate: FAULT (Out of Range)');
      } else if (flow < 120 || flow > 180) {
        if (worstCondition === 'green') worstCondition = 'yellow';
        statusDetails.push('💧 Flow Rate: WARNING (Near Limits)');
      } else {
        statusDetails.push('💧 Flow Rate: Normal');
      }
      
      // Update LED
      setLEDState('monitor-led', 'monitor-status-text', 'monitor-meaning-text', worstCondition);
      
      // Update system health details
      const healthDetails = document.getElementById('system-health-details');
      if (healthDetails) {
        const overallStatus = worstCondition === 'green' ? 'All Systems Normal' : 
                            worstCondition === 'yellow' ? 'Warning Conditions Present' : 
                            'Fault Conditions Detected';
        
        const overallColor = worstCondition === 'green' ? '#4CAF50' : 
                           worstCondition === 'yellow' ? '#FF9800' : '#F44336';
        
        healthDetails.innerHTML = statusDetails.join('<br>') + 
          `<div style="margin-top: 10px; color: ${overallColor}; font-weight: bold;">Overall Status: ${overallStatus}</div>`;
      }
    }
    
    function startAutoMonitoring() {
      const btn = document.getElementById('auto-monitor');
      btn.innerHTML = '<i class="fas fa-stop"></i> Stop Auto Monitoring';
      btn.style.background = '#F44336';
      
      let monitoring = true;
      btn.onclick = () => {
        monitoring = false;
        btn.innerHTML = '<i class="fas fa-play"></i> Start Auto Monitoring';
        btn.style.background = '#2196F3';
        btn.onclick = () => startAutoMonitoring();
      };
      
      // Simulate changing parameters
      const interval = setInterval(() => {
        if (!monitoring) {
          clearInterval(interval);
          return;
        }
        
        // Randomly adjust parameters
        const tempSlider = document.getElementById('temperature-slider');
        const pressureSlider = document.getElementById('pressure-slider');
        const flowSlider = document.getElementById('flow-slider');
        
        const newTemp = Math.min(120, Math.max(50, parseFloat(tempSlider.value) + (Math.random() - 0.5) * 10));
        const newPressure = Math.min(5, Math.max(0, parseFloat(pressureSlider.value) + (Math.random() - 0.5) * 0.5));
        const newFlow = Math.min(300, Math.max(0, parseFloat(flowSlider.value) + (Math.random() - 0.5) * 30));
        
        tempSlider.value = newTemp;
        pressureSlider.value = newPressure;
        flowSlider.value = newFlow;
        
        document.getElementById('temp-value').textContent = newTemp.toFixed(1) + '°C';
        document.getElementById('pressure-value').textContent = newPressure.toFixed(1) + ' bar';
        document.getElementById('flow-value').textContent = newFlow.toFixed(0) + ' L/min';
        
        trackParameterAdjustment('temperature');
        trackParameterAdjustment('pressure');
        trackParameterAdjustment('flow');
        
        updateSystemStatus();
      }, 2000);
    }
    
    function checkStep2Completion() {
      const requiredParams = ['temperature', 'pressure', 'flow'];
      const allAdjusted = requiredParams.every(param => parametersAdjusted.includes(param));
      
      const completeBtn = document.getElementById('complete-step-2');
      if (allAdjusted) {
        completeBtn.disabled = false;
        completeBtn.style.background = '#FF9800';
        completeBtn.innerHTML = '<i class="fas fa-check"></i> Great! Continue to Fault Diagnosis';
      }
    }
    
    // Fault Diagnosis Functions
    function injectFaultScenario(faultType) {
      const faultConfigs = {
        'high-temp': { state: 'red', faults: ['High Temperature (110°C)'], info: 'Temperature sensor reading 110°C - above critical threshold. LED shows solid red indicating immediate action required.' },
        'low-pressure': { state: 'yellow', faults: ['Low Pressure (1.2 bar)'], info: 'System pressure at 1.2 bar - below normal range but not critical. LED shows yellow warning.' },
        'pump-failure': { state: 'flashing-red', faults: ['Pump Motor Failure', 'Flow Rate Zero'], info: 'Complete pump failure detected. LED flashing red indicates critical fault requiring immediate shutdown.' },
        'sensor-drift': { state: 'flashing-yellow', faults: ['Temperature Sensor Drift'], info: 'Temperature sensor showing inconsistent readings. LED flashing yellow indicates escalating warning condition.' },
        'comm-loss': { state: 'flashing-red', faults: ['Communication Timeout', 'PLC Connection Lost'], info: 'Lost communication with main controller. LED flashing red indicates critical system fault.' }
      };
      
      const config = faultConfigs[faultType];
      if (!config) return;
      
      setLEDState('diagnosis-led', 'diagnosis-status-text', 'diagnosis-meaning-text', config.state);
      
      // Update active faults list
      const faultsList = document.getElementById('active-faults-list');
      if (faultsList) {
        faultsList.innerHTML = config.faults.map(fault => `<div style="color: #F44336;">⚠️ ${fault}</div>`).join('');
      }
      
      // Update diagnostic info
      const diagnosticInfo = document.getElementById('diagnostic-info');
      if (diagnosticInfo) {
        diagnosticInfo.innerHTML = config.info;
      }
    }
    
    function clearAllFaults() {
      setLEDState('diagnosis-led', 'diagnosis-status-text', 'diagnosis-meaning-text', 'green');
      
      document.getElementById('active-faults-list').innerHTML = 'No active faults';
      document.getElementById('diagnostic-info').innerHTML = 'All faults cleared. System returned to normal operation.';
    }
    
    function checkStep3Completion() {
      const requiredFaults = ['high-temp', 'low-pressure', 'pump-failure', 'sensor-drift', 'comm-loss'];
      const allExplored = requiredFaults.every(fault => faultsExplored.includes(fault));
      
      const completeBtn = document.getElementById('complete-step-3');
      if (allExplored) {
        completeBtn.disabled = false;
        completeBtn.style.background = '#F44336';
        completeBtn.innerHTML = '<i class="fas fa-check"></i> Excellent! Ready for Final Challenge';
      }
    }
    
    // Troubleshooting Challenge
    function generateTroubleshootingChallenge() {
      const container = document.getElementById('challenge-container');
      
      container.innerHTML = `
        <div style="background: #1a1a1a; border-radius: 12px; padding: 25px;">
          <h5 style="color: #FFFFFF; margin-bottom: 20px;">Scenario: You are called to investigate a system fault</h5>
          
          <div style="display: grid; grid-template-columns: 1fr 1fr; gap: 25px; margin-bottom: 25px;">
            <div style="text-align: center;">
              <div id="challenge-led" style="width: 80px; height: 80px; border-radius: 50%; margin: 0 auto 15px; border: 4px solid #555; background: #FF9800; box-shadow: 0 0 25px rgba(255, 152, 0, 0.6);"></div>
              <div style="font-size: 18px; font-weight: bold; color: #FF9800; margin-bottom: 8px;">Warning</div>
              <div style="font-size: 14px; color: #AAA;">What should be your next action?</div>
            </div>
            
            <div>
              <h6 style="color: #FFFFFF; margin-bottom: 15px;">Select the correct response:</h6>
              <div style="display: grid; gap: 10px;">
                <label style="display: flex; align-items: center; gap: 10px; padding: 10px; background: #333; border-radius: 6px; cursor: pointer;">
                  <input type="radio" name="challenge-answer" value="A">
                  <span style="color: #FFFFFF;">Immediately shut down the system</span>
                </label>
                <label style="display: flex; align-items: center; gap: 10px; padding: 10px; background: #333; border-radius: 6px; cursor: pointer;">
                  <input type="radio" name="challenge-answer" value="B">
                  <span style="color: #FFFFFF;">Investigate the warning condition and check system parameters</span>
                </label>
                <label style="display: flex; align-items: center; gap: 10px; padding: 10px; background: #333; border-radius: 6px; cursor: pointer;">
                  <input type="radio" name="challenge-answer" value="C">
                  <span style="color: #FFFFFF;">Ignore it and continue operation</span>
                </label>
                <label style="display: flex; align-items: center; gap: 10px; padding: 10px; background: #333; border-radius: 6px; cursor: pointer;">
                  <input type="radio" name="challenge-answer" value="D">
                  <span style="color: #FFFFFF;">Reset the system without investigation</span>
                </label>
              </div>
              
              <button id="submit-challenge" style="background: #9C27B0; color: white; border: none; padding: 12px 20px; border-radius: 6px; cursor: pointer; font-weight: bold; width: 100%; margin-top: 15px;">
                Submit Answer
              </button>
            </div>
          </div>
          
          <div id="challenge-feedback" style="display: none; background: #333; border-radius: 8px; padding: 15px;">
            <!-- Feedback will appear here -->
          </div>
        </div>
      `;
      
      document.getElementById('submit-challenge').addEventListener('click', function() {
        const selected = document.querySelector('input[name="challenge-answer"]:checked');
        if (!selected) {
          alert('Please select an answer');
          return;
        }
        
        const feedback = document.getElementById('challenge-feedback');
        const completeBtn = document.getElementById('complete-step-4');
        
        if (selected.value === 'B') {
          feedback.innerHTML = `
            <div style="color: #4CAF50; font-weight: bold; margin-bottom: 10px;">✅ Correct!</div>
            <div style="color: #FFFFFF; font-size: 14px;">
              A yellow warning LED indicates attention is needed but not an immediate emergency. 
              The correct response is to investigate the warning condition, check system parameters, 
              and determine if any corrective action is needed. This prevents minor issues from escalating to critical faults.
            </div>
          `;
          completeBtn.disabled = false;
          completeBtn.style.background = '#9C27B0';
        } else {
          feedback.innerHTML = `
            <div style="color: #F44336; font-weight: bold; margin-bottom: 10px;">❌ Incorrect</div>
            <div style="color: #FFFFFF; font-size: 14px;">
              A yellow warning LED requires investigation, not immediate shutdown or ignoring. 
              Try again and consider what "warning" level means in terms of system priorities.
            </div>
          `;
        }
        
        feedback.style.display = 'block';
      });
    }
    
    function showCompletionMessage() {
      alert('🎉 Congratulations! You have successfully completed the Status LED System training simulation. You now understand how to interpret LED indicators and respond appropriately to different system conditions.');
    }
    
            function submitAnswer(questionNumber) {
      const answerInput = document.querySelector(`[data-question="${questionNumber}"]`);
      if (!answerInput) return;
      
      const selectedOption = document.querySelector(`input[name="question-${questionNumber}"]:checked`);
      if (!selectedOption) {
        alert('Please select an answer before submitting.');
        return;
      }
      
      const answer = selectedOption.value;
      
      // Save with enhanced tracking
      worksheetTracker.saveAnswer(3, questionNumber, answer, 'maintenance');
      
      // Define correct answers for worksheet 3
      const correctAnswers = {
        "1": "A",
        "2": "C",
        "3": "B",
        "4": "D",
        "5": "B"
      };
          
          // Apply visual feedback
          const allOptions = answerInput.querySelectorAll('.option-label');
          const correctAnswer = correctAnswers[questionNumber];
          
          allOptions.forEach(option => {
            const radio = option.querySelector('.option-radio');
            const optionValue = radio.value;
            
            if (optionValue === correctAnswer) {
              option.classList.add('correct');
            } else if (optionValue === answer && answer !== correctAnswer) {
              option.classList.add('incorrect');
            }
          });
          
          // Mark question as submitted to disable further interaction
          answerInput.classList.add('submitted');
          
          // Show feedback on button
          const submitBtn = answerInput.querySelector('.submit-question-btn');
          if (submitBtn) {
            const originalText = submitBtn.textContent;
            submitBtn.textContent = answer === correctAnswer ? 'Correct!' : 'Incorrect!';
            submitBtn.style.background = answer === correctAnswer ? '#4CAF50' : '#f44336';
            
            // Add incorrect class for enhanced styling
            if (answer !== correctAnswer) {
              submitBtn.classList.add('incorrect');
            }
            
            setTimeout(() => {
              submitBtn.textContent = originalText;
              submitBtn.style.background = '#4CAF50';
              submitBtn.classList.remove('incorrect');
            }, 2000);
          }
          
          // Show correct answer if available
          const correctAnswerDiv = answerInput.querySelector('.correct-answer');
          if (correctAnswerDiv) {
            correctAnswerDiv.style.display = 'block';
          }
        }
        function loadSavedAnswers() {
          // This function is now handled by the tracking system
        }
  </script>
  
  <!-- Bottom Navigation -->
  <div class="worksheet-bottom-nav">
    <div class="worksheet-header-content">
      <div class="worksheet-header-left">
        <button class="worksheet-nav-btn worksheet-back-btn" onclick="window.location.href='worksheet-2.html'">
          <i class="fas fa-arrow-left"></i>
          <span>Previous Worksheet</span>
        </button>
      </div>
      <div class="worksheet-header-center">
        <h1 class="worksheet-title">Worksheet 3 - Status LED System Maintenance</h1>
      </div>
      <div class="worksheet-header-right">
        <button class="worksheet-nav-btn worksheet-next-btn" onclick="window.location.href='worksheet-4.html'">
          <span>Next Worksheet</span>
          <i class="fas fa-chevron-right"></i>
        </button>
      </div>
    </div>
  </div>
  
</body>
</html> 