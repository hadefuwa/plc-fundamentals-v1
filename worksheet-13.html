<!DOCTYPE html>
<html lang="en">
<head>
  <meta charset="UTF-8">
  <meta name="viewport" content="width=device-width, initial-scale=1.0">
  <title>Matrix TSL - Analogue Sensors System Maintenance</title>
  <link rel="stylesheet" href="main.css">
  <link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/6.5.1/css/all.min.css">
  <link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/noUiSlider/15.7.1/nouislider.min.css">
  <link rel="icon" type="image/x-icon" href="assets/icons/matrix-icon.ico">
  <script src="https://cdn.jsdelivr.net/npm/chart.js"></script>
  <script src="https://cdnjs.cloudflare.com/ajax/libs/noUiSlider/15.7.1/nouislider.min.js"></script>
  <script src="worksheet-core.js"></script>
  <script src="worksheet-tracking.js"></script>

  <style>
    /* Analogue Sensor Styles */
    .signal-display {
      background: #23272b;
      padding: 20px;
      border-radius: 8px;
      margin-bottom: 15px;
      border: 1px solid #333;
      position: relative;
      overflow: hidden;
    }

    .signal-indicators {
      display: grid;
      grid-template-columns: repeat(3, 1fr);
      gap: 15px;
      margin-bottom: 20px;
    }

    .signal-value {
      background: #1a1a1a;
      padding: 15px;
      border-radius: 8px;
      text-align: center;
    }

    .signal-label {
      color: #aaa;
      font-size: 0.9em;
      margin-bottom: 5px;
    }

    .signal-number {
      font-size: 24px;
      font-weight: bold;
      margin: 10px 0;
    }

    .signal-unit {
      color: #666;
      font-size: 0.8em;
    }

    .voltage .signal-number { color: #2196F3; }
    .raw .signal-number { color: #FF5722; }
    .scaled .signal-number { color: #4CAF50; }

    /* noUiSlider Styles */
    .noUi-target {
      background: #23272b;
      border: none;
      box-shadow: none;
      height: 8px;
    }

    .noUi-connects {
      border-radius: 4px;
      overflow: hidden;
    }

    .noUi-connect {
      border-radius: 4px;
    }

    .noUi-handle {
      width: 24px !important;
      height: 24px !important;
      border-radius: 50% !important;
      background: #fff !important;
      box-shadow: 0 0 10px rgba(0,0,0,0.2) !important;
      border: 2px solid #2196F3 !important;
      cursor: pointer;
    }

    .noUi-handle:before, .noUi-handle:after {
      display: none;
    }

    .noUi-handle:hover {
      box-shadow: 0 0 15px rgba(33,150,243,0.4) !important;
    }

    .noUi-handle:active {
      box-shadow: 0 0 20px rgba(33,150,243,0.6) !important;
    }

    .noUi-tooltip {
      background: #1a1a1a;
      border: 1px solid #333;
      color: #fff;
      font-size: 12px;
      padding: 4px 8px;
    }

    /* Voltage Slider */
    #voltage-slider .noUi-connect {
      background: linear-gradient(to right, #1565C0, #2196F3);
    }

    /* Scaling Slider */
    #scaling-slider .noUi-connect {
      background: linear-gradient(to right, #FFA000, #FFC107);
    }

    /* Offset Slider */
    #offset-slider .noUi-connect {
      background: linear-gradient(to right, #D32F2F, #F44336);
    }

    /* Noise Slider */
    #noise-slider .noUi-connect {
      background: linear-gradient(to right, #388E3C, #4CAF50);
    }

    /* Status Indicators */
    .status-card {
      background: #23272b;
      padding: 15px;
      border-radius: 8px;
      text-align: center;
      border: 1px solid #333;
      transition: all 0.3s ease;
    }

    .status-icon {
      font-size: 24px;
      margin-bottom: 10px;
    }

    .status-label {
      color: #aaa;
      font-size: 0.9em;
      margin-bottom: 5px;
    }

    .status-value {
      font-size: 20px;
      font-weight: bold;
    }

    .status-good {
      color: #4CAF50;
      text-shadow: 0 0 10px rgba(76,175,80,0.4);
    }

    .status-fair {
      color: #FFC107;
      text-shadow: 0 0 10px rgba(255,193,7,0.4);
    }

    .status-poor {
      color: #FF5722;
      text-shadow: 0 0 10px rgba(255,87,34,0.4);
    }

    /* Maintenance Tools */
    .maintenance-btn, .fault-btn {
      width: 100%;
      padding: 12px;
      border: none;
      border-radius: 5px;
      color: white;
      font-weight: bold;
      cursor: pointer;
      transition: all 0.3s ease;
      display: flex;
      align-items: center;
      justify-content: center;
      gap: 10px;
      margin-bottom: 10px;
    }

    .maintenance-btn {
      background: #2196F3;
    }

    .maintenance-btn:hover {
      background: #1976D2;
      box-shadow: 0 0 15px rgba(33,150,243,0.3);
    }

    .fault-btn {
      background: #FF5722;
    }

    .fault-btn:hover {
      background: #F4511E;
      box-shadow: 0 0 15px rgba(255,87,34,0.3);
    }

    /* Task Items */
    .task-item {
      display: flex;
      align-items: center;
      gap: 10px;
      margin-bottom: 10px;
      padding: 10px;
      background: #23272b;
      border-radius: 5px;
      cursor: pointer;
    }

    .task-item input[type="checkbox"] {
      width: 20px;
      height: 20px;
      cursor: pointer;
    }

    .task-item label {
      color: #aaa;
      cursor: pointer;
      flex: 1;
    }

    /* Signal Chart */
    .signal-chart {
      height: 200px;
      margin: 20px 0;
      position: relative;
    }

    /* Diagnostic Log */
    .diagnostic-log {
      background: #23272b;
      padding: 15px;
      border-radius: 5px;
      max-height: 200px;
      overflow-y: auto;
      font-family: monospace;
      color: #aaa;
    }

    .diagnostic-log p {
      margin: 5px 0;
      padding: 5px;
      border-radius: 3px;
      transition: background-color 0.3s ease;
    }

    .diagnostic-log p:hover {
      background: rgba(255,255,255,0.05);
    }

    .timestamp {
      color: #666;
      margin-right: 10px;
    }

    /* Animations */
    @keyframes glowPulse {
      0% { box-shadow: 0 0 5px currentColor; }
      50% { box-shadow: 0 0 15px currentColor; }
      100% { box-shadow: 0 0 5px currentColor; }
    }

    @keyframes valueChange {
      0% { transform: scale(1); }
      50% { transform: scale(1.1); }
      100% { transform: scale(1); }
    }

    @keyframes statusUpdate {
      0% { opacity: 0.7; }
      50% { opacity: 1; }
      100% { opacity: 0.7; }
    }
  </style>
</head>
<body>
  <!-- Navigation -->
  <nav class="main-navigation">
    <div class="nav-container">
      <div class="nav-logo">
        <img src="assets/matrix-logo.png" alt="Matrix Logo">
      </div>
      <ul class="nav-menu" id="nav-menu">
        <li class="nav-item">
          <a href="#" onclick="window.location='index.html'" class="nav-link">
            <i class="fas fa-home"></i> HOME
          </a>
        </li>
        <li class="nav-item">
          <a href="#" onclick="window.location='CP2388-worksheets.html'" class="nav-link">
            <i class="fas fa-cogs"></i> CP2388
          </a>
        </li>
        <li class="nav-item">
          
        </li>
        
        <li class="nav-item">
          <a href="#" onclick="window.location='tracking-dashboard.html'" class="nav-link">
            <i class="fas fa-chart-line"></i> PROGRESS
          </a>
        </li>
        <li class="nav-item">
          <a href="#" onclick="window.location='about.html'" class="nav-link">
            <i class="fas fa-info-circle"></i> ABOUT
          </a>
        </li>
      </ul>
    </div>
  </nav>

  <div class="worksheet-box">
    <!-- Integrated Worksheet Header -->
    <div class="worksheet-header">
      <div class="worksheet-header-content">
        <div class="worksheet-header-left">
          <button class="worksheet-nav-btn worksheet-back-btn" onclick="window.location.href='worksheet-12.html'">
            <i class="fas fa-arrow-left"></i>
            <span>Previous Worksheet</span>
          </button>
        </div>
        <div class="worksheet-header-center">
          <h1 class="worksheet-title">Worksheet 13 - Analogue Sensors System Maintenance</h1>
        </div>
        <div class="worksheet-header-right">
          <button class="worksheet-nav-btn worksheet-next-btn" onclick="window.location.href='worksheet-14.html'">
            <span>Next Worksheet</span>
            <i class="fas fa-chevron-right"></i>
          </button>
        </div>
      </div>
    </div>
    <div class="worksheet-section introduction-section">
      <h2 class="section-header"><i class="fas fa-info-circle"></i> 1. Introduction</h2>
      <div class="worksheet-content">
        <div class="introduction-content-wrapper">
          <div class="introduction-text">
            <p>This worksheet covers maintenance procedures for analogue sensor systems. Analogue sensors provide continuous variable signals (typically 4-20mA or 0-10V) and are essential for precise measurement, process control, and monitoring of continuous variables in industrial systems.</p>
          </div>
          <div class="introduction-image">
            <div class="system-diagram">
              <img src="assets/maintenance/analogue-sensors.png" alt="Analogue Sensors System Maintenance">
            </div>
          </div>
        </div>
      </div>
    </div>

    <!-- Over To You Section -->
    <div class="worksheet-section over-to-you-section">
      <h2 class="section-header"><i class="fas fa-hands-helping"></i> 2. Over To You</h2>
      <div class="worksheet-content">
        <p><strong>Examine the analogue sensor system and understand signal scaling principles:</strong></p>
        
        <div class="steps-container">
          <div class="step-card" data-step="1">
            <div class="step-number">1</div>
            <div class="step-content">
              <div class="step-header">
                <h4>Identify the Analogue Sensor</h4>
                <label class="step-checkbox">
                  <input type="checkbox" class="step-complete-checkbox">
                  <span class="checkmark"></span>
                </label>
              </div>
              <p>Identify the only analogue sensor on this rig - the temperature sensor. Understand that it sends a 0-10V signal to the PLC representing 0-100°C range.</p>
            </div>
          </div>
          
          <div class="step-card" data-step="2">
            <div class="step-number">2</div>
            <div class="step-content">
              <div class="step-header">
                <h4>Explore Scaling Configuration</h4>
                <label class="step-checkbox">
                  <input type="checkbox" class="step-complete-checkbox">
                  <span class="checkmark"></span>
                </label>
              </div>
              <p>Navigate to the IO page and click the "i" button next to the temperature field to view analogue input settings. Test changing the scalar value from 100 to 200 and observe the temperature double, then reset to 100.</p>
            </div>
          </div>
          
          <div class="step-card" data-step="3">
            <div class="step-number">3</div>
            <div class="step-content">
              <div class="step-header">
                <h4>Test Offset Configuration</h4>
                <label class="step-checkbox">
                  <input type="checkbox" class="step-complete-checkbox">
                  <span class="checkmark"></span>
                </label>
              </div>
              <p>Adjust the offset value from 0 to -20 and observe the temperature drop by 20 degrees. Reset the offset back to 0 to restore normal readings.</p>
            </div>
          </div>
        </div>
      </div>
    </div>

    <!-- So What Section -->
    <div class="worksheet-section so-what-section">
      <h2 class="section-header"><i class="fas fa-lightbulb"></i> 3. So What?</h2>
      <div class="so-what-content">
        <p>Analogue sensors provide continuous measurement data that requires proper scaling and calibration:</p>
        
        <div class="key-point">
          <i class="fas fa-lightbulb"></i>
          <div>
            <strong>Signal Scaling</strong>
            <p>PLCs convert analogue signals (0-10V) into raw values (0-27648 on S7-1200), which must be scaled to meaningful engineering units like temperature or pressure.</p>
          </div>
        </div>
        
        <div class="key-point">
          <i class="fas fa-lightbulb"></i>
          <div>
            <strong>Range Matching</strong>
            <p>When sensors are replaced with different ranges (e.g., 0-300°C vs 0-100°C), PLC scaling must be updated to prevent incorrect readings and control errors.</p>
          </div>
        </div>
        
        <div class="key-point">
          <i class="fas fa-lightbulb"></i>
          <div>
            <strong>Offset Correction</strong>
            <p>Offsets compensate for sensor drift or installation variations. A sensor reading 5°C high can be corrected with a -5°C offset to restore accuracy.</p>
          </div>
        </div>
        
        <div class="key-point">
          <i class="fas fa-lightbulb"></i>
          <div>
            <strong>Continuous Monitoring</strong>
            <p>Unlike digital sensors that are simply on/off, analogue sensors provide detailed information about how much something is changing, enabling precise process control.</p>
          </div>
        </div>
      </div>
    </div>

    <div class="worksheet-section questions-section">
      <h2 class="section-header"><i class="fas fa-question-circle"></i> Questions & Answers</h2>
      <div class="questions-content">
        <div class="question-item" data-question="1">
          <h4>Question 1: What is the only analogue sensor used on this training rig, and what does it measure?</h4>
          <div class="multiple-choice-options">
            <label class="option-label">
              <input type="radio" name="question-1" value="A" class="option-radio">
              <span class="option-text">A) The temperature sensor, which measures from 0 to 100°C</span>
            </label>
            <label class="option-label">
              <input type="radio" name="question-1" value="B" class="option-radio">
              <span class="option-text">B) The flow sensor, which measures flow rate</span>
            </label>
            <label class="option-label">
              <input type="radio" name="question-1" value="C" class="option-radio">
              <span class="option-text">C) The pressure sensor, which measures pressure</span>
            </label>
            <label class="option-label">
              <input type="radio" name="question-1" value="D" class="option-radio">
              <span class="option-text">D) The level sensor, which measures tank level</span>
            </label>
          </div>
          <div class="question-actions">
            <button class="submit-question-btn" onclick="submitAnswer(1)">Submit Answer</button>
          </div>
          <div class="correct-answer" style="display: none; margin-top: 15px; padding: 15px; background: #1a2f1a; border-radius: 4px; border-left: 3px solid #4CAF50;">
            <strong style="color: #4CAF50;">Correct Answer:</strong> A) The temperature sensor, which measures from 0 to 100°C.
          </div>
        </div>
        
        <div class="question-item" data-question="2">
          <h4>Question 2: What voltage signal does the temperature sensor send to the PLC, and what temperature range does it represent?</h4>
          <div class="multiple-choice-options">
            <label class="option-label">
              <input type="radio" name="question-2" value="A" class="option-radio">
              <span class="option-text">A) It sends a 0–10V signal, where 0V = 0°C and 10V = 100°C</span>
            </label>
            <label class="option-label">
              <input type="radio" name="question-2" value="B" class="option-radio">
              <span class="option-text">B) It sends a 0–24V signal, where 0V = 0°C and 24V = 100°C</span>
            </label>
            <label class="option-label">
              <input type="radio" name="question-2" value="C" class="option-radio">
              <span class="option-text">C) It sends a 0–5V signal, where 0V = 0°C and 5V = 100°C</span>
            </label>
            <label class="option-label">
              <input type="radio" name="question-2" value="D" class="option-radio">
              <span class="option-text">D) It sends a 0–12V signal, where 0V = 0°C and 12V = 100°C</span>
            </label>
          </div>
          <div class="question-actions">
            <button class="submit-question-btn" onclick="submitAnswer(2)">Submit Answer</button>
          </div>
          <div class="correct-answer" style="display: none; margin-top: 15px; padding: 15px; background: #1a2f1a; border-radius: 4px; border-left: 3px solid #4CAF50;">
            <strong style="color: #4CAF50;">Correct Answer:</strong> C) It sends a 0–5V signal, where 0V = 0°C and 5V = 100°C.
          </div>
        </div>
        
        <div class="question-item" data-question="3">
          <h4>Question 3: What does the PLC do with the analogue voltage signal it receives from the sensor?</h4>
          <div class="multiple-choice-options">
            <label class="option-label">
              <input type="radio" name="question-3" value="A" class="option-radio">
              <span class="option-text">A) The PLC scales the voltage into a real temperature value using a formula, so it can be shown correctly on the HMI</span>
            </label>
            <label class="option-label">
              <input type="radio" name="question-3" value="B" class="option-radio">
              <span class="option-text">B) The PLC amplifies the voltage signal</span>
            </label>
            <label class="option-label">
              <input type="radio" name="question-3" value="C" class="option-radio">
              <span class="option-text">C) The PLC filters the voltage signal</span>
            </label>
            <label class="option-label">
              <input type="radio" name="question-3" value="D" class="option-radio">
              <span class="option-text">D) The PLC stores the voltage signal</span>
            </label>
          </div>
          <div class="question-actions">
            <button class="submit-question-btn" onclick="submitAnswer(3)">Submit Answer</button>
          </div>
          <div class="correct-answer" style="display: none; margin-top: 15px; padding: 15px; background: #1a2f1a; border-radius: 4px; border-left: 3px solid #4CAF50;">
            <strong style="color: #4CAF50;">Correct Answer:</strong> D) The PLC stores the voltage signal.
          </div>
        </div>
        
        <div class="question-item" data-question="4">
          <h4>Question 4: What happens if the sensor range changes from 0–100°C to 0–300°C but the PLC scaling is not updated?</h4>
          <div class="multiple-choice-options">
            <label class="option-label">
              <input type="radio" name="question-4" value="A" class="option-radio">
              <span class="option-text">A) The temperature readings will be wrong. For example, it may show 100°C when the real temperature is actually 300°C</span>
            </label>
            <label class="option-label">
              <input type="radio" name="question-4" value="B" class="option-radio">
              <span class="option-text">B) The temperature readings will be correct</span>
            </label>
            <label class="option-label">
              <input type="radio" name="question-4" value="C" class="option-radio">
              <span class="option-text">C) The system will shut down</span>
            </label>
            <label class="option-label">
              <input type="radio" name="question-4" value="D" class="option-radio">
              <span class="option-text">D) The sensor will stop working</span>
            </label>
          </div>
          <div class="question-actions">
            <button class="submit-question-btn" onclick="submitAnswer(4)">Submit Answer</button>
          </div>
          <div class="correct-answer" style="display: none; margin-top: 15px; padding: 15px; background: #1a2f1a; border-radius: 4px; border-left: 3px solid #4CAF50;">
            <strong style="color: #4CAF50;">Correct Answer:</strong> B) The temperature readings will be correct.
          </div>
        </div>
        
        <div class="question-item" data-question="5">
          <h4>Question 5: Why might an offset be used, and how does it affect the final temperature value?</h4>
          <div class="multiple-choice-options">
            <label class="option-label">
              <input type="radio" name="question-5" value="A" class="option-radio">
              <span class="option-text">A) An offset corrects small errors in readings. For example, if the sensor reads 5°C too high, applying an offset of -5 adjusts it back to the correct value</span>
            </label>
            <label class="option-label">
              <input type="radio" name="question-5" value="B" class="option-radio">
              <span class="option-text">B) An offset increases the measurement range</span>
            </label>
            <label class="option-label">
              <input type="radio" name="question-5" value="C" class="option-radio">
              <span class="option-text">C) An offset is used to filter noise from the signal.</span>
            </label>
            <label class="option-label">
              <input type="radio" name="question-5" value="D" class="option-radio">
              <span class="option-text">D) An offset reduces power consumption</span>
            </label>
          </div>
          <div class="question-actions">
            <button class="submit-question-btn" onclick="submitAnswer(5)">Submit Answer</button>
          </div>
          <div class="correct-answer" style="display: none; margin-top: 15px; padding: 15px; background: #1a2f1a; border-radius: 4px; border-left: 3px solid #4CAF50;">
            <strong style="color: #4CAF50;">Correct Answer:</strong> C) An offset is used to filter noise from the signal.
          </div>
        </div>
      </div>
    </div>

    <!-- Simulation Section -->
    <div class="simulation-section">
      <h2 class="section-header"><i class="fas fa-cogs"></i> 3. Interactive Analogue Sensors System Maintenance</h2>
      <div id="analogue-sensors-panel" class="simulation-container">
        <div class="simulation-loading">
          <i class="fas fa-spinner fa-spin"></i>
          <p>Loading analogue sensors simulation...</p>
          <p>Simulation will initialize automatically</p>
        </div>
      </div>
    </div>
  </div>



  <script src="https://cdnjs.cloudflare.com/ajax/libs/jquery/3.7.1/jquery.min.js"></script>
  <script src="analogue-sensors-simulation.js"></script>
  
  <script>
    // Define correct answers for worksheet 13
    const correctAnswers = {
      "1": "A",
      "2": "C",
      "3": "D",
      "4": "B",
      "5": "C"
    };

    function submitAnswer(questionNumber) {
      const questionItem = document.querySelector(`[data-question="${questionNumber}"]`);
      if (!questionItem) return;
      
      const selectedOption = questionItem.querySelector('.option-radio:checked');
      if (!selectedOption) {
        alert('Please select an answer before submitting.');
        return;
      }
      
      const answer = selectedOption.value;
      
      // Save with enhanced tracking
      worksheetTracker.saveAnswer(13, questionNumber, answer, 'maintenance');
      
      // Apply visual feedback
      const allOptions = questionItem.querySelectorAll('.option-label');
      const correctAnswer = correctAnswers[questionNumber];
      
      allOptions.forEach(option => {
        const radio = option.querySelector('.option-radio');
        const optionValue = radio.value;
        
        if (optionValue === correctAnswer) {
          option.classList.add('correct');
        } else if (optionValue === answer && answer !== correctAnswer) {
          option.classList.add('incorrect');
        }
      });
      
      // Mark question as submitted to disable further interaction
      questionItem.classList.add('submitted');
      
      // Update submit button
      const button = questionItem.querySelector('.submit-question-btn');
      const originalText = button.textContent;
      button.textContent = answer === correctAnswer ? 'Correct!' : 'Incorrect!';
      button.style.background = answer === correctAnswer ? '#4CAF50' : '#f44336';
      
      // Add incorrect class for enhanced styling
      if (answer !== correctAnswer) {
        button.classList.add('incorrect');
      }
      
      setTimeout(() => {
        button.textContent = originalText;
        button.style.background = '#4CAF50';
        button.classList.remove('incorrect');
      }, 2000);

      // Show correct answer
      const correctAnswerDiv = questionItem.querySelector('.correct-answer');
      if (correctAnswerDiv) {
        correctAnswerDiv.style.display = 'block';
      }
    }

    // Initialize when page loads
    document.addEventListener('DOMContentLoaded', function() {
      // Initialize tracking system
      if (typeof worksheetTracker === 'undefined') {
        console.error('Worksheet tracking system not loaded');
        return;
      }

      // Load any saved answers
      const progress = worksheetTracker.getWorksheetProgress(13, 'maintenance');
      if (progress && progress.answers) {
        Object.entries(progress.answers).forEach(([questionNumber, answerData]) => {
          const questionItem = document.querySelector(`[data-question="${questionNumber}"]`);
          if (questionItem) {
            const radio = questionItem.querySelector(`.option-radio[value="${answerData.value}"]`);
            if (radio) {
              radio.checked = true;
              // Show the correct answer for previously answered questions
              const correctAnswerDiv = questionItem.querySelector('.correct-answer');
              if (correctAnswerDiv) {
                correctAnswerDiv.style.display = 'block';
              }
            }
          }
        });
      }
    });
  </script>
  
  <!-- Bottom Navigation -->
  <div class="worksheet-bottom-nav">
    <div class="worksheet-header-content">
      <div class="worksheet-header-left">
        <button class="worksheet-nav-btn worksheet-back-btn" onclick="window.location.href='worksheet-12.html'">
          <i class="fas fa-arrow-left"></i>
          <span>Previous Worksheet</span>
        </button>
      </div>
      <div class="worksheet-header-center">
        <h1 class="worksheet-title">Worksheet 13 - Analogue Sensors System Maintenance</h1>
      </div>
      <div class="worksheet-header-right">
        <button class="worksheet-nav-btn worksheet-next-btn" onclick="window.location.href='worksheet-14.html'">
          <span>Next Worksheet</span>
          <i class="fas fa-chevron-right"></i>
        </button>
      </div>
    </div>
  </div>
  
</body>
</html> 